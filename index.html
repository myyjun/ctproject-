<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>짐 옮기기 (공식 적용 + 타이머)</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .box { border: 1px solid #ccc; padding: 15px; margin: 10px 0; background: #f9f9f9; }
    label, select, input { display: block; margin: 10px 0; }
    #timer { color: red; font-weight: bold; }
    #popup {
      display: none;
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 2px solid black;
      padding: 30px;
      text-align: center;
      z-index: 9999;
    }
    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9998;
    }
  </style>
</head>
<body>

<h1>타이틀: 짐 옮기기</h1>
<p><strong>대상 및 교과:</strong> 특수교육대상학생 고1</p>

<div class="box">
  <h2>지문</h2>
  <p>지점A에서 지점B까지 이동할 때 가영이는 30분, 나영이는 50분이 걸린다.</p>
</div>

<div class="box">
  <h2>규칙</h2>
  <ul>
    <li>한 번에 1개의 상자만 들 수 있음</li>
    <li>상자는 반드시 A에서 B까지 직접 옮겨야 하며, 중간 전달 금지</li>
    <li>옮긴 후엔 다시 A지점으로 돌아와야 다음 박스를 옮길 수 있음</li>
  </ul>
</div>

<div class="box">
  <h2>문제</h2>
  <label for="t1">가영이의 편도 시간 (분):</label>
  <input type="number" id="t1" value="30" />

  <label for="t2">나영이의 편도 시간 (분):</label>
  <input type="number" id="t2" value="50" />

  <label for="n">총 박스 수:</label>
  <input type="number" id="n" value="10" />

  <label for="userAnswer">정답 입력 (단위: 분)</label>
  <input type="number" id="userAnswer" />

  <button onclick="checkAnswer()">문제 풀기</button>
</div>

<div class="box">
  <h2>타이머 설정</h2>
  <label for="timeSelect">제한 시간 선택:</label>
  <select id="timeSelect">
    <option value="30">30초</option>
    <option value="60">1분</option>
    <option value="90">1분 30초</option>
    <option value="120">2분</option>
  </select>
  <button onclick="startTimer()">타이머 시작</button>
  <p id="timer">남은 시간: </p>
</div>

<!-- 팝업과 오버레이 -->
<div id="overlay"></div>
<div id="popup">
  <p>⏰ 시간이 완료되었습니다!</p>
  <button onclick="restart()">다시 도전하기</button>
</div>

<script>
let countdown;

// 공식 기반 계산 함수
function calculateOptimalTime(t1, t2, N) {
  let minTime = Infinity;

  for (let a = 0; a <= N; a++) {
    let b = N - a;

    let gTime = a === 0 ? 0 : t1 + (a - 1) * 2 * t1;
    let nTime = b === 0 ? 0 : t2 + (b - 1) * 2 * t2;

    const totalTime = Math.max(gTime, nTime);

    if (totalTime < minTime) {
      minTime = totalTime;
    }
  }
  return minTime;
}

// 정답 체크
function checkAnswer() {
  const t1 = parseInt(document.getElementById("t1").value);
  const t2 = parseInt(document.getElementById("t2").value);
  const n = parseInt(document.getElementById("n").value);
  const input = parseInt(document.getElementById("userAnswer").value);

  const correct = calculateOptimalTime(t1, t2, n);

  if (input === correct) {
    alert("정답입니다!");
  } else {
    alert(`틀렸습니다. 정답은 ${correct}분입니다.`);
  }
}

// 타이머 시작
function startTimer() {
  clearInterval(countdown);
  const time = parseInt(document.getElementById("timeSelect").value);
  let remaining = time;
  const display = document.getElementById("timer");

  countdown = setInterval(() => {
    if (remaining <= 0) {
      clearInterval(countdown);
      showPopup();
    } else {
      display.textContent = `남은 시간: ${remaining}초`;
      remaining--;
    }
  }, 1000);
}

// 팝업 보이기
function showPopup() {
  document.getElementById("overlay").style.display = "block";
  document.getElementById("popup").style.display = "block";
}

// 다시 도전
function restart() {
  location.reload();
}
</script>

</body>
</html>
